
module my-nginx 1.0;

require {
	type httpd_t;
	type unconfined_t;
	type var_t;
	type var_run_t;
	type httpd_user_content_t;
	type dosfs_t;
	type unreserved_port_t;
	type user_home_t;
	class file { getattr open read };
	class lnk_file read;
	class tcp_socket name_bind;
	class sock_file write;
	class unix_stream_socket connectto;
}

#============= httpd_t ==============

#!!!! This avc is allowed in the current policy
allow httpd_t dosfs_t:file { getattr open read };

#!!!! This avc is allowed in the current policy
allow httpd_t httpd_user_content_t:file read;
allow httpd_t unconfined_t:unix_stream_socket connectto;

#!!!! This avc is allowed in the current policy
allow httpd_t unreserved_port_t:tcp_socket name_bind;

#!!!! This avc is allowed in the current policy
allow httpd_t user_home_t:file read;

#!!!! This avc is allowed in the current policy
allow httpd_t user_home_t:lnk_file read;

#!!!! This avc is allowed in the current policy
allow httpd_t var_run_t:sock_file write;

#!!!! This avc is allowed in the current policy
allow httpd_t var_t:file { getattr read };
